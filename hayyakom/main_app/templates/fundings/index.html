{% extends 'base.html' %}
{% block content %}

<div class="page-header">
    <h1>My Dashboard</h1>
</div>

{% if user.profile.role == 'Owner' %}
{% if not user.company %}
<div class="form-container">
    <h2>Welcome, Business Owner!</h2>
    <p>You need to create a company profile before you can add a funding campaign.</p>
    <a href="{% url 'company_create' %}" class="btn">Create Company Profile</a>
</div>
{% else %}
<div class="company-info-card">
    <h2>My Company</h2>
    <p><strong>Name:</strong> {{ user.company.company_name }}</p>
    <p><strong>CR Number:</strong> {{ user.company.cr_number }}</p>
    <a href="{% url 'company_detail' user.company.id %}" class="btn">View Company Details & Campaigns</a>
</div>
{% endif %}
{% else %}
<div class="investor-dashboard">
    <h2>My Investments</h2>
    <table class="data-table">
        <thead>
            <th>Campaign Name</th>
            <th>My Investment (BD)</th>
            <th>Campaign Progress</th>
            <th>Status</th>
        </thead>
        <tbody>
            {% for investment in my_investments %}
            <tr>
                <td><a href="{% url 'funding_detail' investment.funding.id %}">{{ investment.funding.campaign_name
                        }}</a></td>
                <td>{{ investment.amount }}</td>
                <td>
                    <div class="progress-bar">
                        <div class="progress" style="width: {{ investment.funding.progress_percentage }}%;">
                            {{ investment.funding.progress_percentage|floatformat:2 }}%
                        </div>
                    </div>
                </td>
                <td>{{ investment.status }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">You have not made any investments yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}